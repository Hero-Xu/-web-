<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="animate.css">
	<title>Document</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		ul{
			list-style: none;
		}
		img{
			border: 0;
		}
		a{
			text-decoration: none;
		}
		#container li{
			/*width: 100px;
			height: 100px;*/
			float: left;
			overflow: hidden;
		}
		#container li img{
			width: 100%;
			height: 100%;
		}
	</style>
</head>
<body>
	<ul class="img-container" id="container">
	<!-- 	<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
		<li><img src="me.jpg" alt=""></li>
 -->
	</ul>
	<script src="zepto.min.js"></script>
	<script>
		$(function(){
			$container = $('#container');
			// var html = "";
			var count = 0;
			var padding = 2;
			for (var i = 0; i < 16; i++) {
				// html +=  '<li style="width:'+(Math.floor(iwinwidth / 4))+'px"><img src="img/'+i+'.jpg"></img></li>';
				var oImg = new Image();
				var aImg = [];
				oImg.onload = function(){
					aImg.push(this);
					count++;
					$cvs = $('<canvas></canvas>');
					$li = $('<li></li>');
					$li.append($cvs);
					// $li.append(this);
					$container.append($li);
					// if (count % 4==0) { p = 0;}; 
					if (count==16) {
						$win = $(document.body);
						var iWinWidth = $win.width();
						var img_width = Math.floor((iWinWidth - padding*3)/4);
						var p = padding;

						$('li', $container) .css({paddingTop:padding,paddingRight:p,width:img_width,height:img_width});
						aImg.sort(function(a, b){
							return a.index - b.index;
						})
						$('canvas', $container).each(function(index, elem){
							elem.width = elem.height = img_width;
							var ctx = elem.getContext('2d');
							ctx.drawImage(aImg[index], 0, 0, img_width, img_width);
						});
					}
				}
					oImg.index = i+1;
					oImg.src = 'img/'+(i+1)+'.jpg';
				// $container.append(html);
			};
		})
			
		 	</script>
</body>
</html>